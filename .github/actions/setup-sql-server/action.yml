name: Set up SQL Server
description: Sets up SQL Server with Lombiq-recommended defaults.

runs:
  using: composite
  steps:
    - name: Setup
      shell: pwsh
      run: |
        '${{ github.action_path }}' >> $Env:GITHUB_PATH

    - name: Set up SQL Server
      shell: pwsh
      run: Initialize-SqlServer

    - name: Setup tmate session
      uses: mxschmitt/action-tmate@e5c7151931ca95bad1c6f4190c730ecf8c7dde48 # v3.19

    # Needs to be a separate step, otherwise the Chocolatey installation won't be visible.
    - name: Wait for SQL Server to start
      shell: pwsh
      run: Wait-SqlServer
